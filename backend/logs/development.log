
> backend@1.0.0 start
> node -r dotenv/config server.js

[dotenv@17.2.0] injecting env (0) from .env (tip: üîê encrypt with dotenvx: https://dotenvx.com)
Using local storage service (default)
(node:9933) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:9933) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
MongoDB Connected: shulacluster-shard-00-00.ged8w.mongodb.net
Backend server started on port 5002
üîÑ WebSocket service initialized
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
Client connected
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
User authenticated via WebSocket
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:01.597Z
Route: /api/users?limit=1
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:03.454Z
Route: /api/users?limit=1
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:08.476Z
Route: /api/admin/orders?page=1&limit=12&sortBy=createdAt&sortOrder=desc
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:09.328Z
Route: /api/admin/orders?page=1&limit=12&sortBy=createdAt&sortOrder=desc
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:09.959Z
Route: /api/admin/orders?page=1&limit=12&sortBy=createdAt&sortOrder=desc
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
‚úÖ CORS allowed origin: http://localhost:3000
--- AUTHORIZE MIDDLEWARE DEBUG ---
Timestamp: 2025-08-13T16:23:10.583Z
Route: /api/admin/orders?page=1&limit=12&sortBy=createdAt&sortOrder=desc
Decoded Token User: { id: '68825a1bd28f75825ce6c8e7', role: 'staff' }
User from DB: {
  _id: '68825a1bd28f75825ce6c8e7',
  email: 'einat@shula.com',
  role: 'staff'
}
Required Roles: [ 'staff' ]
Has Role: true
--- END DEBUG LOG ---
